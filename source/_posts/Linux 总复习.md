---

title: Linux 总复习
date: 2020-6-22 21:33:00
tags:
- 课程笔记
mathjax: true

---

# Linux 总复习

## 前言

> 明天就要考试了，我才刚复习完

<!--more-->

## Unix-Linux 操作系统介绍

1. 1973 诞生于**贝尔实验室**

2. 主要版本有**AT&T UNIX System V**与**Berkeley UNIX (BSD)**

3. Linux 由**芬兰**人Linus制作

4. 虚拟终端

      UNIX操作系统向系统中的每个用户指定一个**执行环境**，这个环境称为虚拟终端。

   进程

      UNIX系统通过进程向用户和程序分配资源。

## vi编辑器

### 光标移动

| 命令        | 作用               | 命令    | 作用               |
| ----------- | ------------------ | ------- | ------------------ |
| h           | 左                 | j       | 下                 |
| k           | 上                 | l       | 右                 |
| ctrl+b      | 屏幕往"后"移动一页 | ctrl+f  | 屏幕往"前"移动一页 |
| ctrl+u      | 屏幕往"后"移动半页 | ctrl+d  | 屏幕往"前"移动半页 |
| [RETURN]    | 到下一行行首       | G       | 到文章结尾         |
| [BACKSPACE] | 左                 | [SPACE] | 右                 |
| $           | 到行尾             | 0       | 到行首             |
| w           | 到下个字开头       | e       | 到字尾             |
| b           | 到上个字开头       | $x$l    | 到行的第$x$个位点  |

### 插入模式

1. i：光标处开始编辑
2. a：光标下一位置开始编辑
3. o：下方插入新行开始编辑
4. I：行首输入
5. A：行尾输入
6. O：上方插入新行开始编辑
7. esc：退出编辑模式

### 编辑文字

| 命令 | 作用                   | 命令      | 作用                 |
| ---- | ---------------------- | --------- | -------------------- |
| x    | 删除后一字符           | X         | 删除前一字符         |
| dd   | 删除所在行             | yw        | 复制字到缓冲区       |
| yy   | 复制行到缓冲区         | p         | 向后粘贴缓冲区字符   |
| P    | 向前粘贴缓冲区字符     | .         | 重复操作             |
| r    | 替换所在字符           | R         | 替换模式             |
| u    | 撤回操作               | U         | 撤销对该行的全部操作 |
| c    | 删除文本且进入编辑模式 | *number*G | 到第*number*行       |

### 检索文字

/:向前检索		?:向后检索

### 多文件

载入文件：vi A B C

编辑另一文件： :e A

读另一文件： :r A

写入另一文件： :[a,b]w A   			例：:1,2w A

### 操作域

使用方法：操作符+域

| 标识符 | 意义       | 标识符 | 意义       |
| ------ | ---------- | ------ | ---------- |
| $      | 到行尾     | 0      | 到行首     |
| e/w    | 到当前字尾 | b      | 到前一字尾 |

### 缓冲区 

1. 临时缓冲区：删除和复制的内容总被覆盖到唯一的临时缓冲区

2. 填充数字编号缓冲区：（类似栈）

   每次**复制**的文本都放入缓冲区**0**；

   每次**删除**的文本都放入缓冲区**1-9**；

   缓冲区1中总是存放最近被删除的内容；

   每次有新内容进入缓冲区1-9时，每个缓冲区的内容都要改变，**依次向后移动**内容。

   使用："+*number*+p

3. 字母编号缓冲区：（类似数组）

   共26个，使用小写字母a-z命名；

   通过名称引用其内容；

   有新内容进入缓冲区时，不移动缓冲区内容；

   使用之后，缓冲区内容保持不变。

   使用"+*character*+命令

### 获取光标位置

ctrl+g

### 定制vi

布尔选项：

​	选中： set X			取消：set noX

数字式选项：

​	set x=number

字符串选项

​	set x=string

:set all	——在屏幕上显示所有的选项

:set		 ——只显示修改过的选项

:set *X*?   ——显示选项*X*的值

#### 布尔选项

| 变量       | 作用                     |
| ---------- | ------------------------ |
| autoident  | 将新行与前一行的行首对齐 |
| ignorecase | 查询忽略大小写           |
| magic      | 搜索时允许使用元字符     |
| number     | 显示行号                 |
| showmode   | 显示当前模式(命令/编辑)  |

#### 数字式选项

| 变量       | 作用                   |
| ---------- | ---------------------- |
| report     | 通知用户命令所影响的行 |
| scroll     | ctrl+d默认翻动行数     |
| shiftwidth | 设置缩进长度           |
| warpmargin | 设置行长               |

#### 宏替换

:ab 缩写 原语：当输入缩写时自动转换为原语

:map 按键 操作：当按下按键时自动执行操作 			*unmap取消*

#### 配置文件

vi按照下面顺序寻找 **.exrc**文件：

1. 查找当前工作目录

2. 查找主目录

### 其他vi命令 

| 命令       | 功能          | 命令 | 功能   |
| ---------- | ------------- | ---- | ------ |
| :! command | 执行shell命令 | J    | 连接行 |
| vi -r A    | 文件崩溃恢复  |      |        |

   ​	

## 文件系统

### 文件分类

1. 普通文件：包含字节序列，如程序代码、数据、文本等。
2. 目录文件：特殊的普通文件，其内容为关于文件的信息。
3. 特殊文件：主要是设备文件。每个外部设备对应一个文件。

### root下目录

| 目录   | 存放信息                     | 目录        | 存放信息                       |
| ------ | ---------------------------- | ----------- | ------------------------------ |
| /bin   | 存放root权限指令             | /dev        | 存放设备文件                   |
| /home  | 存放用户目录                 | /lib64 /lib | 存放启动系统的命令             |
| /mnt   | 光驱和其他临时文件系统目录   | /proc       | 虚拟目录                       |
| /run   | 加载了临时文件系统文件的目录 | /tmp        | 存放临时文件                   |
| /srv   | 存放网络服务                 | /var        | 存放可能会用的文件，包括cache  |
| /boot  | 存放开机会用的档案           | /etc        | 存放主要的配置文件             |
| /media | 挂载可移除的装置             | /opt        | 存储第三方软件                 |
| /root  | root用户的主目录             | /sbin       | 存放root用户使用的系统设定命令 |
| /sys   | 虚拟文件目录                 | /usr        | 存放用户主目录和其他目录文件   |

### 目录命令

| 命令   | 功能                                             | 命令   | 功能                                         |
| ------ | ------------------------------------------------ | ------ | -------------------------------------------- |
| pwd    | 显示当前工作目录                                 | cd     | 改变工作目录                                 |
| mkdir  | 创建目录                                         | rmdir  | 删除目录                                     |
| cat    | 显示一个或多个文件内容。                         | lp     | 将文件发送给打印机。                         |
| lpr    | Linux打印命令。                                  | cancel | 取消打印命令。                               |
| lpstat | 获取打印机状态命令。                             | rm     | 获取打印机状态命令。                         |
| rm -i  | 删除前请求确认                                   | rm -r  | 删除指定目录与目录下所有文件与子目录         |
| view   | 只读显示                                         | pr     | 排版输出                                     |
| ln     | 在已存在文件i节点和新文件名之间创建新链接        | wc     | -l统计行数-w统计字数-c统计字符数             |
| head   | -n显示前n行；-c字符计数                          | tail   | -n显示前n行；-c字符计数                      |
| cut    | 截取指定字段。-f域分割；-c字符数；-d；指定分隔符 | paste  | 逐行连接文件，将两个或多个文件的域连接到一起 |

#### ls：

功能：显示目录内信息

| 选项 | 功能                       | 选项 | 功能         |
| ---- | -------------------------- | ---- | ------------ |
| -a   | 显示所有文件               | -C   | 多列显示     |
| -F   | 目录名后+/，可执行文件后+* | -l   | 显示详细信息 |
| -m   | 页宽显示                   | -R   | 循环显示     |
| -s   | 以块为单位显示文件大小     | -i   | 查看i结点号  |

#### pg，more与less：

pg功能：读文件

more功能：另起一页读文件

less功能：同more，但允许文件中向前移动

| 选项 | 功能                 | 选项      | 功能                          |
| ---- | -------------------- | --------- | ----------------------------- |
| -n   | 不需要回车结束单命令 | -s        | 反白显示信息与提示            |
| -num | 设置每屏行数         | -p        | 修改提示符                    |
| +num | 从num行开始显示      | +/pattern | 从第一个含pattern的行开始显示 |

#### cp：

功能：复制文件

| 选项 | 功能                       | 选项 | 功能               |
| ---- | -------------------------- | ---- | ------------------ |
| -b   | 若文件重名则创建备份后覆盖 | -i   | 如已存在则需要确认 |
| -r   | 目录复制至新目录           |      |                    |

#### mv：

功能：移到文件

| 选项 | 功能                                   | 选项 | 功能               |
| ---- | -------------------------------------- | ---- | ------------------ |
| -b   | 若文件重名则创建备份后覆盖             | -i   | 如已存在则需要确认 |
| -f   | 如果目标文件已经存在，就删除目标文件。 | -v   | 解释操作。         |

#### find:

功能：查找文件

-：以内	+：以外

| 选项              | 功能             | 选项                | 功能             |
| ----------------- | ---------------- | ------------------- | ---------------- |
| -name             | 文件名查找       | -size+-n            | 文件大小查找     |
| -type             | 文件类型查找     | -atime+-n           | 最后访问日期查找 |
| -mtime+-n         | 最后修改日期查找 | -newer              | 查找更新文件     |
| -print            | 输出路径         | -exec command {} \; | 找到后执行命令   |
| -ok command {} \; | 执行前需确认     |                     |                  |



### 文件权限

例：drw-r--r--  1  david  student  48  Jun 25  12:28   memos

第一列，字符串类型，10个字符组成：drw-r--r-- 

第1个字符是**文件类型**：“d”是目录，“-”是普通文件，“b”是块设备文件，“c”是字符设备文件，“l”是链接文件。

第2-10字符是**文件访问模式**，3个字符一组，描述了三类用户的权限。第一组是文件所有者权限，第二组是同组用户权限，第三组是其他用户权限。

第二列，数字类型：1   			 		      该文件的**链接数**。可以使用ln命令查看链接情况。

第三列，字符串类型：david  	 		     文件的**所有者**。

第四列，字符串类型：student			     文件的**所属的组**。每个用户有一个用户ID和组ID，由系统管理员分配。

第五列，数字类型：48 			 		      文件的大小，单位为字节。

第四列，日期时间类型：Jun 25  12:28   文件上一次修改的日期和时间。

第四列，字符串类型：memos 			    文件的名称。

普通文件默认权限为777，目录文件默认权限为666，创建时实际权限为默认权限减去umask

### 重定向

#### 输出重定向

\>\> 	追加重定向 

\> 	  覆盖重定向

#### 输入重定向

命令格式：

*command* < *filename* 	正常使用

*command* << *filename*   脚本文件中使用

### 正则表达式与通配符

| 元字符              | 含义                                  | 元字符 | 含义                 |
| ------------------- | ------------------------------------- | ------ | -------------------- |
| .                   | 匹配新行字符以外的字符                | ^      | 匹配行首             |
| $                   | 匹配行尾                              | \<     | 匹配词首             |
| \>                  | 匹配词尾                              | [list] | 匹配list内的字符     |
| [^list]             | 不匹配list中的字符                    | ()     | 视作单元             |
| <code>&#124;</code> | 交变，匹配选择之一                    | \      | 引用，字面解释元字符 |
| *                   | 匹配任意次                            | +      | 匹配一次或多次       |
| ?                   | 匹配0次或1次                          | {n}    | 匹配n次              |
| {n,m}               | 匹配次数$n\leq x\leq m$其中n，m可忽略 |        |                      |



## 用户与组

1. UID

   root账户：0

   系统用户：1-499

   普通用户：500-60000

2. 用户信息存放于/etc/passwd，加密后口令存放于/etc/shadow，组信息存放于/etc/group

3. who am i显示当前终端最初登录的帐户;whoami显示当前终端当前用户

4. su 切换用户，参数缺省时切换至root

## 终端

真正的硬件终端基本上已经看不到了，现在所说的终端、伪终端都是软件仿真终端(即终端模拟软件)

一些连接了键盘和显示器的系统中，我们可以接触到运行在内核态的软件仿真终端(tty1-tty6)

通过 SSH 等方式建立的连接中使用的都是伪终端

伪终端是运行在用户态的软件仿真终端。

## SHELL

1. SHELL种类：BASH/KSH/SH/CSH/TCSH

2. 退出SHELL：ctrl+d

3. 终止前台进程：ctrl+c

4. . filename 与 exec filename 不会创建子shell。

5. ./filename;$filename;\`filename\` 会创建子shell

6. echo：将消息及参数显示在用户终端上

   消除转义

   \：转义后方字符

   “：特例有$ ` "，保留空白符

   ‘：消除一切特殊含义

7. set：查看当前使用的shell变量

8. unset：删除shell变量

9. shell标准变量

   HOME：用户主目录

   PATH：设置shell定位命令（程序）时所要查找的目录序列，路径串中以冒号分隔。

   PS1：命令行提示符

   
   
   | 转义序列 | 显示内容        | 转义序列 | 显示内容             |
   | -------- | --------------- | -------- | -------------------- |
   | \u      | 用户名          | \h      | 主机名               |
   | \W      | 最底层工作目录  | \$       | root时显示#其余显示$ |
   | \s      | 当前的shell环境 | \w      | 完整工作路径         |
| \d      | 日期            | \t      | 时间                 |
   | !         |  命令序号               |          |                      |

   PS2:命令换行时显示前缀
   
   CDPATH：cd可达的快捷入口
   
   SHELL：当前shell
   
   TERM：当前终端类型

   TZ：时区信息

10. 其他元字符

   ``：执行反引号内命令

   ;：顺序执行命令

   ()：命令编组

   &：后台执行

   |：管道，前者输出为后者输入

11. 其他命令

    

| 命令  | 功能                     | 命令   | 功能                      |
| ----- | ----------------- | :----- | -------------------------|
| sleep | 延时                     | ps     | 显示活动进程              |
| nohup | 用户退出时不关闭后台进程 | kill   | 终止进程                  |
| tee   | 输出到屏幕同时保存       | grep   | 搜索文档内信息            |
| sort  | 排序命令                 | export | 使变量可用于子SHELL       |
| alias | 为命令起别名             | ualias | 取消别名(\可用于屏蔽别名) |

12. 系统配置文件：/etc/profile

    用户配置文件：~/.profile

    子shell死亡时唤醒父shell

## SHELL编程

\#用于注释

\#!用于确定后续代码发送路径，即修改编译器。

变量无需声明，只需定义

命令行参数


| 变量 | 含义                 | 变量     | 含义         |
| ---- | -------------------- | -------- | ------------ |
| $0   | 脚本文件名           | \$1-\$9  | 九个参数     |
| $#   | 参数个数             | \$@、\$* | 包含所有参数 |
| $?   | 最后一个命令退出状态 | \$\$     | pid          |

| 命令  | 功能                                     | 命令 | 功能     |
| ----- | ---------------------------------------- | ---- | -------- |
| chmod | 设置权限                                 | .    | 执行程序 |
| read  | 读取变量(多出的变量全部加入最后一个变量) | exit | 终止程序 |

条件控制

```shell
if [ condition ]
then
	commands
elif
	commands
else
	commands
fi
#[ condition ]是test命令的一种特殊形式
```

test操作符

| 操作符 | 含义                     | 操作符 | 含义                     |
| ------ | ------------------------ | ------ | ------------------------ |
| -eq    | 判等                     | -ne    | 判不等                   |
| -gt    | 大于                     | -ge    | 大于等于                 |
| -lt    | 小于                     | -le    | 小于等于                 |
| -a     | 逻辑与                   | -o     | 逻辑或                   |
| !      | 逻辑非                   | =      | 字符串判等               |
| !=     | 字符串判不等             | -n     | 字符串是否包含           |
| -z     | 判断是否空串             | -r     | 文件是否存在且可读       |
| -w     | 文件是否存在且可写       | -s     | 文件是否存在且长度非0    |
| -f     | 文件是否存在且是普通文件 | -d     | 文件是否存在且是目录文件 |

    缩写为[]，但若缩写为[[]]括号内可不需转义符。

expr：

expr 参数1 操作符 参数2（空格必须存在）

| 操作符 | 含义     | 操作符 | 含义 |
| ------ | -------- | ------ | ---- |
| +      | 加       | -      | 减   |
| \\*    | 乘       | /      | 除   |
| \\%    | 取模     | =      | 判等 |
| !=     | 判不等   | \\<    | 小于 |
| \\<=   | 小于等于 | \\>    | 大于 |
| \\>=   | 大于等于 |        |      |

let：

可用于整数运算例 let x=x+1

缩写为(())

循环结构

```
for x in 1 2 3
do
	commands
done
while [ condition ]
do
	commands
done
until [ condition ]
do 
	commands
done
```



## 其他命令

| 命令      | 功能             | 命令       | 功能               |
| --------- | ---------------- | ---------- | ------------------ |
| df        | 显示未用磁盘空间 | du         | 统计磁盘使用情况   |
| banner    | 显示标题         | at         | 指定时间执行       |
| type      | 显示命令类型     | time       | 统计程序运行时间   |
| calendar  | 提醒             | finger     | 显示用户的详细信息 |
| ccrypt -e | 加密             | ccrypt -d  | 解密               |
| compress  | 压缩             | uncompress | 解压               |
| telnet    | 连接远程服务器   |            |                    |

### tar

存档和分发文件

| 选项 | 功能               | 选项     | 功能           |
| ---- | ------------------ | -------- | -------------- |
| A    | 存档合并           | c        | 建立新存档     |
| d    | 比较存档与当下区别 | --delete | 删除存档       |
| r    | 附加到存档解为     | t        | 列出存档目录   |
| u    | 新存档覆盖         | x        | 从存档中展开   |
| v    | 详细显示处理文件   | f        | 指定存档与设备 |

### FTP

| 命令     | 功能                    | 命令    | 功能                |
| -------- | ----------------------- | ------- | ------------------- |
| open     | 建立连接                | close   | 关闭连接返回本地ftp |
| quit/bye | 关闭连接返回shell       | ascii   | 文本模式            |
| binary   | 二进制模式              | get     | 下载                |
| mget     | 下载多个                | put     | 上传                |
| mput     | 上传多个                | cd      | 到服务器目录        |
| lcd      | 到本地目录              | dir/ls  | 列出服务器目录内容  |
| pwd      | 显示服务期目录名        | mkdir   | 创建目录            |
| delete   | 删除指定文件            | mdelete | 删除多个文件        |
| ？       | 帮助内容                | !       | 临时切换shell       |
| hash     | 传送一个数据库显示一个# |         |                     |

## 实验题重点题归纳

1. 复制当前文件的5行，保存到其文件garden5中。 :1,5 w garden5

2. 查找主目录中，所有7天内修改过的文件，将其复制到memos目录中。find . -mtime +7 -exec cp {} ~/memos \;

3. 创建map键[F3]，用它查找包含指定字符串的行并删除该行.。  :map <f3> /kill<CR>dd

4. 检查文件sum.sh是否存在（按e选择）

   ​          修改文件权限为可执行（按m选择）。

   ​          测试执行a.sh，显示正确率（按x选择）。

   ```shell
   	echo "检查文件sum.sh是否存在（按e选择）"
   	echo "修改文件权限为可执行（按m选择）。"
   	echo "测试执行a.sh，显示正确率（按x选择）。"
   	read op
   	if [ $op = e ]
   	then
   	echo "the status of sum.sh is "
   	num="`find sum.sh|wc -l`"
   	if [ $num -eq 1 ]
   	then
   	echo "it exist"
   	fi
   	elif [ $op = m ]
   	then
   	chmod a+x sum.sh
   	elif [ $op = x ]
   	then
   	ans1="`sum.sh 1 100|grep -o -E '(-?)[0-9]*'`"
   	ans2="`sum.sh -1 10|grep -o -E '(-?)[0-9]*'`"
   	ans3="`sum.sh -10 -1|grep -o -E '(-?)[0-9]*'`"
   	ans4="`sum.sh 100 1|grep -o -E '(-?)[0-9]*'`"
   	ans5="`sum.sh 1 1|grep -o -E '(-?)[0-9]*'`"
   	ct=0
   	if [ $ans1 -eq 5050 ]
   	then
   	let ct=ct+1
   	fi
   
   	if [ $ans2 -eq 54 ]
   	then
   	let ct=ct+1
   	fi
   
   	if [ $ans3 -eq -55 ]
   	then
   	let ct=ct+1
   	fi
   
   	if [ $ans4 -eq 0 ]
   	then
   	let ct=ct+1
   	fi
   
   	if [ $ans5 -eq 1 ]
   	then
   	let ct=ct+1
   	fi
   	echo "$ct\\5"
   	fi
   
   ```

5. 生成001~100，大于47的进入big，其余进入small

   ```shell
   touch ~/MyDoc/big
   touch ~/MyDoc/small
   a=A
   for i in `seq -w 1 100`
   do
   	c=$a$i
   	if [ "$i" -gt "047" ]
   	then
   		echo $c>>~/MyDoc/big
   	else
   		echo $c>>~/MyDoc/small
   	fi
   done
   ```

   